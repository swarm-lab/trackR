<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>3 - Background tab • trackR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="3 - Background tab">
<meta property="og:description" content="trackR">
<meta property="og:image" content="https://swarm-lab.github.io/trackR/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">trackR</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.5.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/z1_install.html">1 - Installing trackR</a>
    </li>
    <li>
      <a href="../articles/z2_video.html">2 - Video tab</a>
    </li>
    <li>
      <a href="../articles/z3_background.html">3 - Background tab</a>
    </li>
    <li>
      <a href="../articles/z4_mask.html">4 - Mask tab</a>
    </li>
    <li>
      <a href="../articles/z5_blob.html">5 - Blob tab</a>
    </li>
    <li>
      <a href="../articles/z6_tracking.html">6 - Tracking tab</a>
    </li>
    <li>
      <a href="../articles/z7_settings.html">7 - Save/load settings</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/swarm-lab/trackR/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="z3_background_files/header-attrs-2.6/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>3 - Background tab</h1>
                        <h4 class="author">Simon Garnier</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/swarm-lab/trackR/blob/master/vignettes/z3_background.Rmd"><code>vignettes/z3_background.Rmd</code></a></small>
      <div class="hidden name"><code>z3_background.Rmd</code></div>

    </div>

    
    
<p><mark><strong>This page applies to <code><a href="../reference/trackR.html">trackR("classic")</a></code> and <code><a href="../reference/trackR.html">trackR("quanta")</a></code>. Skip it if you’re using <code><a href="../reference/trackR.html">trackR("tracktor")</a></code>.</strong></mark></p>
<hr>
<p><code>trackR</code> can use two different background subtraction methods in order to isolate objects from their surrounding background:</p>
<ol style="list-style-type: decimal">
<li>
<strong>“Classic” background subtraction</strong>: this method consists in subtracting an image representing a fixed background from each frame of the video. Pixels with high difference values in the resulting image will correspond to objects moving in front of the background.</li>
<li>
<strong>“Quantized” background subtraction</strong>: this method consists in identifying pixels that are significantly lighter or darker than the usual shade at their location in the image. This is accomplished by estimating for each pixel the lower and upper bounds of the confidence interval of its distribution of shades.<br>
If for a given image the pixel value falls outside of one of these bounds, then the pixel is considered as belonging to an object and not to the background.</li>
</ol>
<p>For instructions on “classic” background subtraction, go to <a href="#classic-background-subtraction">“Classic” background subtraction</a>.</p>
<p>For instructions on “quantized” background subtraction, go to <a href="#quantized-background-subtraction">“Quantized” background subtraction</a></p>
<hr>
<div id="classic-background-subtraction" class="section level2">
<h2 class="hasAnchor">
<a href="#classic-background-subtraction" class="anchor"></a>1 - “Classic” background subtraction</h2>
<ul>
<li><a href="#classic1">1 - Using an existing background image</a></li>
<li><a href="#classic2">2 - Creating a background image from the video</a></li>
<li><a href="#classic3">3 - Removing ghosts</a></li>
</ul>
<center>
<img src="../man/figures/background_classic.png" style="width:50.0%">
</center>
<hr>
<div id="classic1" class="section level3">
<h3 class="hasAnchor">
<a href="#classic1" class="anchor"></a>1 - Using an existing background image</h3>
<p>If you have recorded a background image of your experimental setup, or if you have created and saved one following the instructions in the <a href="#classic1">next section</a>, you can load it by clicking on the <code>Select background  file or...</code> button in the <code>Background</code> tab (see screenshot above). This will bring up a file navigator. Use the file navigator to locate and select the background image that you would like to use. If the image is correctly loaded in <code>trackR</code>, it should appear in the display window.</p>
<p>Note: the background image should have the same dimensions as the video.</p>
<hr>
</div>
<div id="classic2" class="section level3">
<h3 class="hasAnchor">
<a href="#classic2" class="anchor"></a>2 - Creating a background image from the video</h3>
<p>If you do not have recorded a background image or want to create one from the video, you first need to select the number of video frames you would like to use for estimating the background. You can do this using the <code>Number of frames</code> slider in the <code>Background</code> tab (see screenshot above). Selecting more images will usually lead to a more accurate result, but will take longer.</p>
<p>Once you have selected a number of frames, you need to select the type of algorithms that you would like to use for estimating the background image. Two algorithms are available in <code>trackR</code>:</p>
<ol style="list-style-type: decimal">
<li>
<code>Mean</code>: this calculates an average image from the selected video frames. This is a fast algorithm. However it does not always produce good results.</li>
<li>
<code>Median</code>: this calculates a median image from the selected video frames. This usually produces a better result than <code>Mean</code>, but will take a significantly longer amount of time.</li>
</ol>
<p>You can select the algorithm using the <code>Type</code> dropdown menu. You can then click on the <code>...Estimate background</code> button to start the computation of the background image.</p>
<p>Once the background image is estimated, it should appear in the display window. You can save this image for later use by clicking on the <code>Save background file</code> button.</p>
<hr>
</div>
<div id="classic3" class="section level3">
<h3 class="hasAnchor">
<a href="#classic3" class="anchor"></a>3 - Removing ghosts</h3>
<p>In some instance (e.g. when an object does not move for a significant portion of the video), the background image may contain “ghosts”. To remove a ghost, click on the <code>Select ghost for removal</code> button in the <code>Background</code> tab (see screenshot above). Then, use left-mouse clicks in the display window to draw a polygon around the ghost you want to remove (see image below for an example). Close the polygon using a right-mouse click. <code>trackR</code> will then use an inpainting algorithm to remove the ghost from the background image.</p>
<hr>
<center>
<img src="../man/figures/ghost.png" style="width:75.0%">
</center>
<hr>
<p>Repeat this operation as many times as necessary to remove all the unwanted ghosts.</p>
<p>Note: inpainting is not an exact science and the result of removing ghosts may not be satisfying. In this case, use a more advanced image editing program such as Adobe Photoshop or Gimp to clean up your background image.</p>
<hr>
</div>
</div>
<div id="quantized-background-subtraction" class="section level2">
<h2 class="hasAnchor">
<a href="#quantized-background-subtraction" class="anchor"></a>2 - “Quantized” background subtraction</h2>
<ul>
<li><a href="#quanta1">1 - Using an existing background image</a></li>
<li><a href="#quanta2">2 - Creating a background image from the video</a></li>
<li><a href="#quanta3">3 - Removing ghosts</a></li>
</ul>
<center>
<img src="../man/figures/background_quanta.png" style="width:50.0%">
</center>
<hr>
<div id="quanta1" class="section level3">
<h3 class="hasAnchor">
<a href="#quanta1" class="anchor"></a>1 - Using an existing background image</h3>
<p>If you have created and saved a background image following the instructions in the <a href="#quanta2">next section</a>, you can load it by clicking on the <code>Select background  file or...</code> button in the <code>Background</code> tab (see screenshot above). This will bring up a file navigator. Use the file navigator to locate and select the background image that you would like to use. If the image is correctly loaded in <code>trackR</code>, it should appear in the display window.</p>
<hr>
</div>
<div id="quanta2" class="section level3">
<h3 class="hasAnchor">
<a href="#quanta2" class="anchor"></a>2 - Creating a background image from the video</h3>
<p>If you want to create a background image from the video, you first need to select the number of video frames you would like to use for estimating the background. You can do this using the <code>Number of frames</code> slider in the <code>Background</code> tab (see screenshot above). Selecting more images will usually lead to a more accurate result, but will take longer.</p>
<p>Once you have selected a number of frames, you need to select the type of object that you would like to track. If the objects are generally darker than the background, select <code>Objects darker than the background</code> in the <code>type</code> dropdown menu. Otherwise, select <code>Objects lighter than the background</code>.</p>
<p>You can then click on the <code>...Estimate background</code> button to start the computation of the background image.</p>
<p>Once the background image is estimated, it should appear in the display window. You can save this image for later use by clicking on the <code>Save background file</code> button.</p>
<hr>
</div>
<div id="quanta3" class="section level3">
<h3 class="hasAnchor">
<a href="#quanta3" class="anchor"></a>3 - Removing ghosts</h3>
<p>In some instance (e.g. when an object does not move for a significant portion of the video), the background image may contain “ghosts”. To remove a ghost, click on the <code>Select ghost for removal</code> button in the <code>Background</code> tab (see screenshot above). Then, use left-mouse clicks in the display window to draw a polygon around the ghost you want to remove (see image below for an example). Close the polygon using a right-mouse click. <code>trackR</code> will then use an inpainting algorithm to remove the ghost from the background image.</p>
<hr>
<center>
<img src="../man/figures/ghost.png" style="width:75.0%">
</center>
<hr>
<p>Repeat this operation as many times as necessary to remove all the unwanted ghosts.</p>
<p>Note: inpainting is not an exact science and the result of removing ghosts may not be satisfying. In this case, use a more advanced image editing program such as Adobe Photoshop or Gimp to clean up your background image.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="http://www.theswarmlab.com">Simon Garnier</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '5cc7571ea2edfcf1062359e583eb942a',
    indexName: 'swarm-lab-trackr',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
